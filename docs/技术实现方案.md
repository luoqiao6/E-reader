# ç”µå­ä¹¦é˜…è¯»å™¨ - æŠ€æœ¯å®ç°æ–¹æ¡ˆ

> **æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
> **åˆ›å»ºæ—¥æœŸ**: 2026-01-29  
> **è®¾è®¡å·¥å…·**: Pencil Design System  

---

## ğŸ“‹ ç›®å½•

1. [æ¦‚è¿°](#æ¦‚è¿°)
2. [æŠ€æœ¯æ ˆé€‰æ‹©](#æŠ€æœ¯æ ˆé€‰æ‹©)
3. [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
4. [æ ¸å¿ƒåŠŸèƒ½æ¨¡å—](#æ ¸å¿ƒåŠŸèƒ½æ¨¡å—)
5. [æ•°æ®ç»“æ„è®¾è®¡](#æ•°æ®ç»“æ„è®¾è®¡)
6. [ç»„ä»¶è®¾è®¡](#ç»„ä»¶è®¾è®¡)
7. [ä¸»é¢˜ç³»ç»Ÿå®ç°](#ä¸»é¢˜ç³»ç»Ÿå®ç°)
8. [çŠ¶æ€ç®¡ç†æ–¹æ¡ˆ](#çŠ¶æ€ç®¡ç†æ–¹æ¡ˆ)
9. [æ€§èƒ½ä¼˜åŒ–ç­–ç•¥](#æ€§èƒ½ä¼˜åŒ–ç­–ç•¥)
10. [å¼€å‘è·¯çº¿å›¾](#å¼€å‘è·¯çº¿å›¾)

---

## æ¦‚è¿°

åŸºäºPencilè®¾è®¡ç¨¿å®ç°çš„æ¡Œé¢ç«¯ç”µå­ä¹¦é˜…è¯»å™¨åº”ç”¨ï¼Œæ”¯æŒå¤šæ ¼å¼ç”µå­ä¹¦å¯¼å…¥ã€æ²‰æµ¸å¼é˜…è¯»ä½“éªŒã€ä¸°å¯Œçš„ä¸ªæ€§åŒ–è®¾ç½®å’Œä¸»é¢˜ç®¡ç†åŠŸèƒ½ã€‚

### æ ¸å¿ƒç‰¹æ€§

- ğŸ“š æ”¯æŒEPUBã€PDFã€TXTç­‰å¤šç§æ ¼å¼
- ğŸ¨ é¢„è®¾ä¸»é¢˜ + æ— é™è‡ªå®šä¹‰ä¸»é¢˜
- âš™ï¸ å…¨é¢çš„é˜…è¯»è®¾ç½®ï¼ˆå­—ä½“ã€å­—å·ã€å­—é—´è·ã€è¡Œè·ã€é¢œè‰²ï¼‰
- ğŸ”– ä¹¦ç­¾ã€é«˜äº®ã€ç¬”è®°åŠŸèƒ½
- ğŸ“Š é˜…è¯»è¿›åº¦è¿½è¸ª
- ğŸ” å…¨æ–‡æœç´¢
- ğŸ’¾ æœ¬åœ°æ•°æ®æŒä¹…åŒ–

---

## æŠ€æœ¯æ ˆé€‰æ‹©

### æ¨èæ–¹æ¡ˆä¸€ï¼šElectron + Reactï¼ˆæœ€ä½³æ¡Œé¢ä½“éªŒï¼‰

**æ ¸å¿ƒæŠ€æœ¯æ ˆ**
- **æ¡†æ¶**: Electron 28+ (è·¨å¹³å°æ¡Œé¢åº”ç”¨)
- **å‰ç«¯**: React 18+ + TypeScript
- **çŠ¶æ€ç®¡ç†**: Zustand (è½»é‡çº§ã€ç®€å•æ˜“ç”¨)
- **æ ·å¼æ–¹æ¡ˆ**: CSS Modules + PostCSS
- **ç”µå­ä¹¦è§£æ**: 
  - EPUB: `epubjs` (v0.3+)
  - PDF: `pdfjs-dist` (v3+)
  - TXT: åŸç”Ÿå®ç°
- **æœ¬åœ°å­˜å‚¨**: IndexedDB + `localforage`
- **æ„å»ºå·¥å…·**: Vite + electron-vite

**ä¸ºä»€ä¹ˆé€‰æ‹©è¿™å¥—æ–¹æ¡ˆï¼Ÿ**
- âœ… Electronæä¾›å®Œæ•´çš„æ¡Œé¢ç«¯èƒ½åŠ›ï¼ˆæ–‡ä»¶ç³»ç»Ÿè®¿é—®ã€çª—å£ç®¡ç†ï¼‰
- âœ… Reactç”Ÿæ€æˆç†Ÿï¼Œç»„ä»¶åŒ–å¼€å‘æ•ˆç‡é«˜
- âœ… TypeScriptæä¾›ç±»å‹å®‰å…¨ï¼Œå‡å°‘è¿è¡Œæ—¶é”™è¯¯
- âœ… Zustandè½»é‡çº§ï¼Œå­¦ä¹ æˆæœ¬ä½ï¼Œæ€§èƒ½å¥½
- âœ… epubjsæ˜¯ä¸šç•Œæ ‡å‡†çš„EPUBè§£æåº“

### æ¨èæ–¹æ¡ˆäºŒï¼šTauri + Svelteï¼ˆè½»é‡é«˜æ€§èƒ½ï¼‰

**æ ¸å¿ƒæŠ€æœ¯æ ˆ**
- **æ¡†æ¶**: Tauri 1.5+ (è½»é‡çº§æ¡Œé¢æ¡†æ¶)
- **å‰ç«¯**: Svelte 4+ + TypeScript
- **çŠ¶æ€ç®¡ç†**: Svelte Stores
- **æ ·å¼æ–¹æ¡ˆ**: SvelteåŸç”Ÿ + PostCSS
- **ç”µå­ä¹¦è§£æ**: åŒæ–¹æ¡ˆä¸€
- **æœ¬åœ°å­˜å‚¨**: Tauriçš„å­˜å‚¨API + SQLite
- **æ„å»ºå·¥å…·**: Vite

**ä¸ºä»€ä¹ˆé€‰æ‹©è¿™å¥—æ–¹æ¡ˆï¼Ÿ**
- âœ… ä½“ç§¯æ›´å°ï¼ˆ~3MB vs ~50MB Electronï¼‰
- âœ… æ€§èƒ½æ›´å¥½ï¼ˆRuståç«¯ï¼‰
- âœ… å†…å­˜å ç”¨æ›´ä½
- âœ… Svelteç¼–è¯‘æ—¶æ¡†æ¶ï¼Œè¿è¡Œæ—¶æ€§èƒ½ä¼˜å¼‚

### æ¨èæ–¹æ¡ˆä¸‰ï¼šWebåº”ç”¨ + PWAï¼ˆè·¨å¹³å°æœ€ä¼˜ï¼‰

**æ ¸å¿ƒæŠ€æœ¯æ ˆ**
- **æ¡†æ¶**: React 18+ / Vue 3+
- **çŠ¶æ€ç®¡ç†**: Redux Toolkit / Pinia
- **æ ·å¼æ–¹æ¡ˆ**: Tailwind CSS
- **PWA**: Workbox
- **ç”µå­ä¹¦è§£æ**: åŒæ–¹æ¡ˆä¸€
- **æœ¬åœ°å­˜å‚¨**: IndexedDB + Cache API
- **æ„å»ºå·¥å…·**: Vite

**ä¸ºä»€ä¹ˆé€‰æ‹©è¿™å¥—æ–¹æ¡ˆï¼Ÿ**
- âœ… çœŸæ­£çš„è·¨å¹³å°ï¼ˆæ¡Œé¢ã€å¹³æ¿ã€æ‰‹æœºï¼‰
- âœ… æ— éœ€å®‰è£…ï¼Œé€šè¿‡æµè§ˆå™¨è®¿é—®
- âœ… è‡ªåŠ¨æ›´æ–°ï¼Œæ— éœ€ç”¨æˆ·æ‰‹åŠ¨å‡çº§
- âœ… å¼€å‘å’Œéƒ¨ç½²æˆæœ¬ä½

### æœ€ç»ˆæ¨èï¼šElectron + React

åŸºäº"é€‚ç”¨äºPCå’Œç¬”è®°æœ¬ç”µè„‘"çš„éœ€æ±‚ï¼Œæ¨èä½¿ç”¨ **Electron + React** æ–¹æ¡ˆï¼ŒåŸå› ï¼š
1. å®Œæ•´çš„æ¡Œé¢åº”ç”¨ä½“éªŒ
2. å®Œå–„çš„æ–‡ä»¶ç³»ç»Ÿè®¿é—®èƒ½åŠ›
3. ä¸°å¯Œçš„ç¬¬ä¸‰æ–¹åº“å’Œç¤¾åŒºæ”¯æŒ
4. ä¸Pencilè®¾è®¡ç¨¿çš„äº¤äº’æ¨¡å¼å®Œç¾åŒ¹é…

---

## ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Electron Main Process                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Window Mgmt â”‚  â”‚ File Handler â”‚  â”‚  IPC Bridge      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ IPC Communication
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Electron Renderer Process                 â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                   React Application                     â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚   UI Layer  â”‚  â”‚ Logic Layer â”‚  â”‚  Data Layer  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚             â”‚  â”‚             â”‚  â”‚              â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ Components  â”‚â†’â”‚  Services   â”‚â†’â”‚   Stores     â”‚  â”‚ â”‚
â”‚  â”‚  â”‚             â”‚  â”‚             â”‚  â”‚              â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ - StartPage â”‚  â”‚ - BookMgr   â”‚  â”‚ - BookStore  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ - Reader    â”‚  â”‚ - ThemeMgr  â”‚  â”‚ - ThemeStore â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ - Settings  â”‚  â”‚ - SettingMgrâ”‚  â”‚ - UIStore    â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                  Book Parser Layer                      â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚ â”‚
â”‚  â”‚  â”‚  EPUB    â”‚  â”‚   PDF    â”‚  â”‚   TXT    â”‚            â”‚ â”‚
â”‚  â”‚  â”‚  Parser  â”‚  â”‚  Parser  â”‚  â”‚  Parser  â”‚            â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                 Storage Layer (IndexedDB)               â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  Books | Settings | Themes | Bookmarks | Progress     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç›®å½•ç»“æ„

```
ebook-reader/
â”œâ”€â”€ electron/                  # Electronä¸»è¿›ç¨‹
â”‚   â”œâ”€â”€ main.ts               # ä¸»è¿›ç¨‹å…¥å£
â”‚   â”œâ”€â”€ preload.ts            # é¢„åŠ è½½è„šæœ¬
â”‚   â””â”€â”€ handlers/             # IPCå¤„ç†å™¨
â”‚       â”œâ”€â”€ file.ts           # æ–‡ä»¶æ“ä½œ
â”‚       â””â”€â”€ window.ts         # çª—å£ç®¡ç†
â”œâ”€â”€ src/                      # Reactåº”ç”¨æºç 
â”‚   â”œâ”€â”€ main.tsx              # Reactå…¥å£
â”‚   â”œâ”€â”€ App.tsx               # æ ¹ç»„ä»¶
â”‚   â”œâ”€â”€ pages/                # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ StartPage.tsx     # å¯åŠ¨é¡µ
â”‚   â”‚   â””â”€â”€ ReaderPage.tsx    # é˜…è¯»é¡µ
â”‚   â”œâ”€â”€ components/           # UIç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Reader/           # é˜…è¯»å™¨ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ ReaderView.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ TopBar.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ProgressBar.tsx
â”‚   â”‚   â”‚   â””â”€â”€ SettingsPanel.tsx
â”‚   â”‚   â”œâ”€â”€ BookCard/         # ä¹¦ç±å¡ç‰‡
â”‚   â”‚   â”œâ”€â”€ ThemeSelector/    # ä¸»é¢˜é€‰æ‹©å™¨
â”‚   â”‚   â””â”€â”€ UI/               # é€šç”¨UIç»„ä»¶
â”‚   â”‚       â”œâ”€â”€ Button.tsx
â”‚   â”‚       â”œâ”€â”€ Dropdown.tsx
â”‚   â”‚       â”œâ”€â”€ ColorPicker.tsx
â”‚   â”‚       â””â”€â”€ Input.tsx
â”‚   â”œâ”€â”€ services/             # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ bookService.ts    # ä¹¦ç±ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ themeService.ts   # ä¸»é¢˜ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ settingsService.ts# è®¾ç½®ç®¡ç†
â”‚   â”‚   â””â”€â”€ parsers/          # è§£æå™¨
â”‚   â”‚       â”œâ”€â”€ epubParser.ts
â”‚   â”‚       â”œâ”€â”€ pdfParser.ts
â”‚   â”‚       â””â”€â”€ txtParser.ts
â”‚   â”œâ”€â”€ stores/               # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ bookStore.ts      # ä¹¦ç±çŠ¶æ€
â”‚   â”‚   â”œâ”€â”€ themeStore.ts     # ä¸»é¢˜çŠ¶æ€
â”‚   â”‚   â”œâ”€â”€ settingsStore.ts  # è®¾ç½®çŠ¶æ€
â”‚   â”‚   â””â”€â”€ uiStore.ts        # UIçŠ¶æ€
â”‚   â”œâ”€â”€ hooks/                # è‡ªå®šä¹‰Hooks
â”‚   â”‚   â”œâ”€â”€ useBook.ts
â”‚   â”‚   â”œâ”€â”€ useTheme.ts
â”‚   â”‚   â””â”€â”€ useSettings.ts
â”‚   â”œâ”€â”€ types/                # TypeScriptç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ book.ts
â”‚   â”‚   â”œâ”€â”€ theme.ts
â”‚   â”‚   â””â”€â”€ settings.ts
â”‚   â”œâ”€â”€ styles/               # å…¨å±€æ ·å¼
â”‚   â”‚   â”œâ”€â”€ global.css
â”‚   â”‚   â”œâ”€â”€ themes.css
â”‚   â”‚   â””â”€â”€ variables.css
â”‚   â””â”€â”€ utils/                # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ storage.ts
â”‚       â”œâ”€â”€ format.ts
â”‚       â””â”€â”€ constants.ts
â”œâ”€â”€ public/                   # é™æ€èµ„æº
â”‚   â””â”€â”€ fonts/                # å­—ä½“æ–‡ä»¶
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ vite.config.ts
â””â”€â”€ electron-builder.json     # æ‰“åŒ…é…ç½®
```

---

## æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

### 1. å¯åŠ¨é¡µæ¨¡å— (StartPage)

**åŠŸèƒ½**
- æ˜¾ç¤ºæ¬¢è¿æ ‡é¢˜å’Œå‰¯æ ‡é¢˜
- æä¾›"å¯¼å…¥æ–°ä¹¦"å’Œ"æ‰“å¼€æ–‡ä»¶"æŒ‰é’®
- å±•ç¤ºæœ€è¿‘é˜…è¯»çš„ä¹¦ç±åˆ—è¡¨ï¼ˆä¹¦åã€ä½œè€…ã€å°é¢ã€è¿›åº¦ï¼‰
- ç‚¹å‡»ä¹¦ç±å¡ç‰‡å¿«é€Ÿæ‰“å¼€

**å…³é”®ç»„ä»¶**
```typescript
// StartPage.tsx
interface StartPageProps {
  recentBooks: Book[];
  onImportBook: () => void;
  onOpenBook: (bookId: string) => void;
}

// BookCard.tsx
interface BookCardProps {
  book: Book;
  onClick: () => void;
}
```

**å®ç°è¦ç‚¹**
- ä¹¦ç±å°é¢ä½¿ç”¨å ä½å›¾æ ‡æˆ–ç¼©ç•¥å›¾
- æ”¯æŒæ‹–æ‹½æ–‡ä»¶å¯¼å…¥
- æœ€è¿‘é˜…è¯»åˆ—è¡¨ä»IndexedDBè¯»å–ï¼Œæœ€å¤šæ˜¾ç¤º20æœ¬

### 2. é˜…è¯»å™¨æ¨¡å— (Reader)

**åŠŸèƒ½**
- æ¸²æŸ“ç”µå­ä¹¦å†…å®¹ï¼ˆæ”¯æŒEPUBã€PDFã€TXTï¼‰
- çºµå‘æ»šåŠ¨é˜…è¯»
- é¡¶éƒ¨å·¥å…·æ ï¼ˆè¿”å›ã€ä¹¦åã€æœç´¢ã€ä¹¦ç­¾ã€è®¾ç½®ï¼‰
- åº•éƒ¨è¿›åº¦æ¡
- å³ä¾§è®¾ç½®é¢æ¿

**å…³é”®ç»„ä»¶**
```typescript
// ReaderPage.tsx
interface ReaderPageProps {
  bookId: string;
}

// ReaderView.tsx
interface ReaderViewProps {
  content: string;
  settings: ReaderSettings;
}

// TopBar.tsx
interface TopBarProps {
  bookTitle: string;
  onBack: () => void;
  onSearch: () => void;
  onBookmark: () => void;
  onSettings: () => void;
}

// ProgressBar.tsx
interface ProgressBarProps {
  current: number;
  total: number;
}
```

**å®ç°è¦ç‚¹**
- ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨ä¼˜åŒ–é•¿æ–‡æ¡£æ€§èƒ½
- å®æ—¶ä¿å­˜é˜…è¯»è¿›åº¦ï¼ˆèŠ‚æµï¼Œæ¯5ç§’ä¿å­˜ä¸€æ¬¡ï¼‰
- å“åº”é”®ç›˜å¿«æ·é”®ï¼ˆç©ºæ ¼ç¿»é¡µã€æ–¹å‘é”®æ»šåŠ¨ç­‰ï¼‰

### 3. è®¾ç½®é¢æ¿æ¨¡å— (SettingsPanel)

**åŠŸèƒ½**
- å­—ä½“é€‰æ‹©ï¼ˆä¸‹æ‹‰æ¡†ï¼‰
- å­—å·è°ƒèŠ‚ï¼ˆ+/- æŒ‰é’®ï¼‰
- å­—é—´è·é€‰æ‹©ï¼ˆä¸‹æ‹‰æ¡†ï¼‰
- è¡Œè·é€‰æ‹©ï¼ˆä¸‹æ‹‰æ¡†ï¼‰
- ä¸»é¢˜åˆ‡æ¢ï¼ˆé¢„è®¾ä¸»é¢˜ + è‡ªå®šä¹‰ä¸»é¢˜ï¼‰
- èƒŒæ™¯é¢œè‰²é€‰æ‹©å™¨
- å­—ä½“é¢œè‰²é€‰æ‹©å™¨
- ä¿å­˜è‡ªå®šä¹‰ä¸»é¢˜
- æˆ‘çš„ä¸»é¢˜åˆ—è¡¨ï¼ˆå¯åˆ é™¤ï¼‰
- æ»šåŠ¨æç¤º

**å…³é”®ç»„ä»¶**
```typescript
// SettingsPanel.tsx
interface SettingsPanelProps {
  isOpen: boolean;
  settings: ReaderSettings;
  themes: Theme[];
  onClose: () => void;
  onSettingsChange: (settings: Partial<ReaderSettings>) => void;
  onThemeSelect: (themeId: string) => void;
  onThemeSave: (name: string) => void;
  onThemeDelete: (themeId: string) => void;
}

// ThemeSelector.tsx
interface ThemeSelectorProps {
  themes: Theme[];
  activeThemeId: string;
  isCustom: boolean;
  onSelect: (themeId: string) => void;
}

// ColorPicker.tsx
interface ColorPickerProps {
  value: string;
  onChange: (color: string) => void;
}
```

**å®ç°è¦ç‚¹**
- è®¾ç½®å˜åŒ–å®æ—¶åº”ç”¨åˆ°é˜…è¯»è§†å›¾
- æ£€æµ‹ç”¨æˆ·æ‰‹åŠ¨ä¿®æ”¹ï¼Œè‡ªåŠ¨åˆ‡æ¢åˆ°"è‡ªå®šä¹‰"ä¸»é¢˜
- ä¸»é¢˜æ•°æ®åŒ…å«å®Œæ•´çš„è®¾ç½®å‚æ•°
- æ”¯æŒå¯¼å…¥/å¯¼å‡ºä¸»é¢˜ï¼ˆå¯é€‰åŠŸèƒ½ï¼‰

### 4. ä¸»é¢˜ç³»ç»Ÿæ¨¡å— (ThemeManager)

**åŠŸèƒ½**
- ç®¡ç†é¢„è®¾ä¸»é¢˜ï¼ˆæµ…è‰²ã€æ·±è‰²ã€æš–è‰²ï¼‰
- ç®¡ç†ç”¨æˆ·è‡ªå®šä¹‰ä¸»é¢˜
- åº”ç”¨ä¸»é¢˜åˆ°é˜…è¯»ç•Œé¢
- æŒä¹…åŒ–ä¸»é¢˜æ•°æ®

**æ•°æ®ç»“æ„**
```typescript
interface Theme {
  id: string;
  name: string;
  type: 'preset' | 'custom';
  settings: {
    fontFamily: string;
    fontSize: number;
    letterSpacing: 'tight' | 'normal' | 'wide';
    lineHeight: number;
    backgroundColor: string;
    textColor: string;
  };
  createdAt?: Date;
}

// é¢„è®¾ä¸»é¢˜
const PRESET_THEMES: Theme[] = [
  {
    id: 'light',
    name: 'æµ…è‰²ä¸»é¢˜',
    type: 'preset',
    settings: {
      fontFamily: 'Playfair Display',
      fontSize: 20,
      letterSpacing: 'normal',
      lineHeight: 1.8,
      backgroundColor: '#FFFFFF',
      textColor: '#000000',
    },
  },
  {
    id: 'dark',
    name: 'æ·±è‰²ä¸»é¢˜',
    type: 'preset',
    settings: {
      fontFamily: 'Playfair Display',
      fontSize: 20,
      letterSpacing: 'normal',
      lineHeight: 1.8,
      backgroundColor: '#1A1A1A',
      textColor: '#E0E0E0',
    },
  },
  {
    id: 'warm',
    name: 'æš–è‰²ä¸»é¢˜',
    type: 'preset',
    settings: {
      fontFamily: 'Playfair Display',
      fontSize: 20,
      letterSpacing: 'normal',
      lineHeight: 1.8,
      backgroundColor: '#F5F1E8',
      textColor: '#3A3A3A',
    },
  },
];
```

### 5. ä¹¦ç±ç®¡ç†æ¨¡å— (BookManager)

**åŠŸèƒ½**
- å¯¼å…¥ç”µå­ä¹¦æ–‡ä»¶
- è§£æç”µå­ä¹¦å…ƒæ•°æ®ï¼ˆä¹¦åã€ä½œè€…ã€å°é¢ï¼‰
- ç®¡ç†ä¹¦ç±åˆ—è¡¨
- åˆ é™¤ä¹¦ç±
- æœç´¢ä¹¦ç±

**æ•°æ®ç»“æ„**
```typescript
interface Book {
  id: string;
  title: string;
  author: string;
  cover?: string; // Base64 æˆ– URL
  format: 'epub' | 'pdf' | 'txt';
  filePath: string;
  fileSize: number;
  totalPages: number;
  currentPage: number;
  progress: number; // 0-100
  lastReadAt: Date;
  createdAt: Date;
}

interface BookContent {
  bookId: string;
  chapters: Chapter[];
  content: string;
}

interface Chapter {
  id: string;
  title: string;
  startPage: number;
  endPage: number;
}
```

### 6. ä¹¦ç­¾ä¸ç¬”è®°æ¨¡å— (BookmarkManager)

**åŠŸèƒ½**
- æ·»åŠ /åˆ é™¤ä¹¦ç­¾
- æ·»åŠ /ç¼–è¾‘/åˆ é™¤ç¬”è®°
- æ–‡æœ¬é«˜äº®
- ä¹¦ç­¾åˆ—è¡¨å±•ç¤º

**æ•°æ®ç»“æ„**
```typescript
interface Bookmark {
  id: string;
  bookId: string;
  page: number;
  position: number; // é¡µé¢ä¸­çš„ä½ç½®
  text: string; // ä¹¦ç­¾å¤„çš„æ–‡æœ¬ç‰‡æ®µ
  note?: string;
  createdAt: Date;
}

interface Highlight {
  id: string;
  bookId: string;
  page: number;
  startOffset: number;
  endOffset: number;
  text: string;
  color: string;
  note?: string;
  createdAt: Date;
}
```

### 7. æœç´¢æ¨¡å— (SearchManager)

**åŠŸèƒ½**
- å…¨æ–‡æœç´¢
- æœç´¢ç»“æœé«˜äº®
- è·³è½¬åˆ°æœç´¢ç»“æœ

**å®ç°**
```typescript
interface SearchResult {
  page: number;
  text: string;
  matchIndex: number;
}

async function searchInBook(
  bookId: string,
  query: string
): Promise<SearchResult[]> {
  // 1. ä»IndexedDBè¯»å–ä¹¦ç±å†…å®¹
  // 2. ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æœç´¢
  // 3. è¿”å›ç»“æœåˆ—è¡¨
}
```

---

## æ•°æ®ç»“æ„è®¾è®¡

### IndexedDB Schema

```typescript
// æ•°æ®åº“è®¾è®¡
const DB_NAME = 'EbookReaderDB';
const DB_VERSION = 1;

// å¯¹è±¡å­˜å‚¨ï¼ˆè¡¨ï¼‰
const STORES = {
  books: 'books',           // ä¹¦ç±ä¿¡æ¯
  bookContents: 'bookContents', // ä¹¦ç±å†…å®¹
  settings: 'settings',     // å…¨å±€è®¾ç½®
  themes: 'themes',         // ç”¨æˆ·ä¸»é¢˜
  bookmarks: 'bookmarks',   // ä¹¦ç­¾
  highlights: 'highlights', // é«˜äº®
  progress: 'progress',     // é˜…è¯»è¿›åº¦
};

// ç´¢å¼•è®¾è®¡
const INDEXES = {
  books: ['lastReadAt', 'title', 'author'],
  bookmarks: ['bookId', 'createdAt'],
  highlights: ['bookId', 'createdAt'],
  progress: ['bookId', 'updatedAt'],
};
```

### LocalStorage (å¿«é€Ÿè®¿é—®)

```typescript
// å­˜å‚¨å½“å‰æ´»åŠ¨çš„è®¾ç½®ï¼Œé¿å…é¢‘ç¹è¯»å–IndexedDB
const LOCAL_STORAGE_KEYS = {
  CURRENT_THEME_ID: 'currentThemeId',
  CURRENT_BOOK_ID: 'currentBookId',
  LAST_SETTINGS: 'lastSettings',
  UI_STATE: 'uiState', // å¦‚è®¾ç½®é¢æ¿æ˜¯å¦æ‰“å¼€
};
```

---

## ç»„ä»¶è®¾è®¡

### è®¾è®¡åŸåˆ™

1. **ç»„ä»¶åŒ–**: æ‹†åˆ†ä¸ºå°è€Œä¸“æ³¨çš„ç»„ä»¶
2. **å¯å¤ç”¨**: UIç»„ä»¶ä¸ä¸šåŠ¡é€»è¾‘åˆ†ç¦»
3. **ç±»å‹å®‰å…¨**: å®Œæ•´çš„TypeScriptç±»å‹å®šä¹‰
4. **æ€§èƒ½ä¼˜åŒ–**: ä½¿ç”¨React.memoã€useMemoã€useCallback

### å…³é”®ç»„ä»¶å®ç°ç¤ºä¾‹

#### 1. é˜…è¯»è§†å›¾ç»„ä»¶

```typescript
// components/Reader/ReaderView.tsx
import React, { useEffect, useRef } from 'react';
import { useReaderSettings } from '@/hooks/useSettings';
import styles from './ReaderView.module.css';

interface ReaderViewProps {
  content: string;
  bookId: string;
}

export const ReaderView: React.FC<ReaderViewProps> = ({ content, bookId }) => {
  const { settings } = useReaderSettings();
  const containerRef = useRef<HTMLDivElement>(null);

  // åº”ç”¨é˜…è¯»è®¾ç½®åˆ°CSSå˜é‡
  useEffect(() => {
    if (containerRef.current) {
      const element = containerRef.current;
      element.style.setProperty('--font-family', settings.fontFamily);
      element.style.setProperty('--font-size', `${settings.fontSize}px`);
      element.style.setProperty('--line-height', `${settings.lineHeight}`);
      element.style.setProperty('--letter-spacing', getLetterSpacing(settings.letterSpacing));
      element.style.setProperty('--background-color', settings.backgroundColor);
      element.style.setProperty('--text-color', settings.textColor);
    }
  }, [settings]);

  // æ»šåŠ¨ä½ç½®æ¢å¤
  useEffect(() => {
    // ä»IndexedDBè¯»å–ä¸Šæ¬¡çš„æ»šåŠ¨ä½ç½®
    // æ¢å¤æ»šåŠ¨ä½ç½®
  }, [bookId]);

  // æ»šåŠ¨ä½ç½®ä¿å­˜ï¼ˆèŠ‚æµï¼‰
  useEffect(() => {
    const handleScroll = () => {
      // èŠ‚æµä¿å­˜æ»šåŠ¨ä½ç½®åˆ°IndexedDB
    };

    const element = containerRef.current;
    element?.addEventListener('scroll', handleScroll);
    return () => element?.removeEventListener('scroll', handleScroll);
  }, [bookId]);

  return (
    <div ref={containerRef} className={styles.readerView}>
      <div 
        className={styles.content}
        dangerouslySetInnerHTML={{ __html: content }}
      />
    </div>
  );
};

function getLetterSpacing(value: string): string {
  const map = {
    tight: '-0.02em',
    normal: '0',
    wide: '0.05em',
  };
  return map[value] || '0';
}
```

```css
/* ReaderView.module.css */
.readerView {
  width: 100%;
  height: 100%;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 80px;
  background-color: var(--background-color);
  color: var(--text-color);
  
  /* è‡ªå®šä¹‰æ»šåŠ¨æ¡ */
  scrollbar-width: thin;
  scrollbar-color: #888 transparent;
}

.readerView::-webkit-scrollbar {
  width: 8px;
}

.readerView::-webkit-scrollbar-track {
  background: transparent;
}

.readerView::-webkit-scrollbar-thumb {
  background: #888;
  border-radius: 4px;
}

.readerView::-webkit-scrollbar-thumb:hover {
  background: #555;
}

.content {
  max-width: 800px;
  margin: 0 auto;
  font-family: var(--font-family);
  font-size: var(--font-size);
  line-height: var(--line-height);
  letter-spacing: var(--letter-spacing);
}

.content p {
  margin-bottom: 2em;
}

.content h1,
.content h2,
.content h3 {
  margin-top: 2em;
  margin-bottom: 1em;
}
```

#### 2. è®¾ç½®é¢æ¿ç»„ä»¶

```typescript
// components/Reader/SettingsPanel.tsx
import React, { useState, useEffect } from 'react';
import { useThemeStore } from '@/stores/themeStore';
import { useSettingsStore } from '@/stores/settingsStore';
import { Dropdown } from '@/components/UI/Dropdown';
import { ColorPicker } from '@/components/UI/ColorPicker';
import { ThemeSelector } from '@/components/ThemeSelector';
import styles from './SettingsPanel.module.css';

interface SettingsPanelProps {
  isOpen: boolean;
  onClose: () => void;
}

export const SettingsPanel: React.FC<SettingsPanelProps> = ({
  isOpen,
  onClose,
}) => {
  const { settings, updateSettings } = useSettingsStore();
  const {
    themes,
    activeThemeId,
    isCustomMode,
    applyTheme,
    saveTheme,
    deleteTheme,
  } = useThemeStore();

  const [themeName, setThemeName] = useState('');

  // ç›‘å¬è®¾ç½®å˜åŒ–ï¼Œè‡ªåŠ¨åˆ‡æ¢åˆ°è‡ªå®šä¹‰æ¨¡å¼
  useEffect(() => {
    // å¦‚æœç”¨æˆ·æ‰‹åŠ¨ä¿®æ”¹äº†è®¾ç½®ï¼Œåˆ‡æ¢åˆ°è‡ªå®šä¹‰æ¨¡å¼
  }, [settings]);

  const handleThemeSelect = (themeId: string) => {
    applyTheme(themeId);
  };

  const handleSaveTheme = () => {
    if (themeName.trim()) {
      saveTheme(themeName, settings);
      setThemeName('');
    }
  };

  if (!isOpen) return null;

  return (
    <div className={styles.panel}>
      <div className={styles.header}>
        <h3 className={styles.title}>é˜…è¯»è®¾ç½®</h3>
        <button className={styles.closeBtn} onClick={onClose}>
          âœ•
        </button>
      </div>

      <div className={styles.divider} />

      {/* å­—ä½“é€‰æ‹© */}
      <div className={styles.section}>
        <label className={styles.label}>å­—ä½“</label>
        <Dropdown
          value={settings.fontFamily}
          options={FONT_OPTIONS}
          onChange={(value) => updateSettings({ fontFamily: value })}
        />
      </div>

      {/* å­—å·è°ƒèŠ‚ */}
      <div className={styles.section}>
        <label className={styles.label}>å­—å·</label>
        <div className={styles.sizeControl}>
          <button onClick={() => updateSettings({ fontSize: settings.fontSize - 1 })}>
            -
          </button>
          <span>{settings.fontSize}</span>
          <button onClick={() => updateSettings({ fontSize: settings.fontSize + 1 })}>
            +
          </button>
        </div>
      </div>

      {/* å­—é—´è·é€‰æ‹© */}
      <div className={styles.section}>
        <label className={styles.label}>å­—é—´è·</label>
        <Dropdown
          value={settings.letterSpacing}
          options={LETTER_SPACING_OPTIONS}
          onChange={(value) => updateSettings({ letterSpacing: value })}
        />
      </div>

      {/* è¡Œè·é€‰æ‹© */}
      <div className={styles.section}>
        <label className={styles.label}>è¡Œè·</label>
        <Dropdown
          value={settings.lineHeight}
          options={LINE_HEIGHT_OPTIONS}
          onChange={(value) => updateSettings({ lineHeight: value })}
        />
      </div>

      {/* ä¸»é¢˜é€‰æ‹© */}
      <div className={styles.section}>
        <label className={styles.label}>ä¸»é¢˜</label>
        <ThemeSelector
          themes={themes.filter((t) => t.type === 'preset')}
          activeThemeId={activeThemeId}
          isCustom={isCustomMode}
          onSelect={handleThemeSelect}
        />
        <p className={styles.hint}>
          é€‰æ‹©ä¸»é¢˜å°†è‡ªåŠ¨åº”ç”¨æ‰€æœ‰è®¾ç½®ï¼Œä¿®æ”¹è®¾ç½®åå°†åˆ‡æ¢ä¸ºè‡ªå®šä¹‰æ¨¡å¼
        </p>
      </div>

      {/* èƒŒæ™¯é¢œè‰² */}
      <div className={styles.section}>
        <label className={styles.label}>èƒŒæ™¯é¢œè‰²</label>
        <ColorPicker
          value={settings.backgroundColor}
          onChange={(color) => updateSettings({ backgroundColor: color })}
        />
      </div>

      {/* å­—ä½“é¢œè‰² */}
      <div className={styles.section}>
        <label className={styles.label}>å­—ä½“é¢œè‰²</label>
        <ColorPicker
          value={settings.textColor}
          onChange={(color) => updateSettings({ textColor: color })}
        />
      </div>

      <div className={styles.divider} />

      {/* ä¿å­˜å½“å‰è®¾ç½® */}
      <div className={styles.section}>
        <label className={styles.label}>ä¿å­˜å½“å‰è®¾ç½®</label>
        <input
          type="text"
          placeholder="è¾“å…¥ä¸»é¢˜åç§°..."
          value={themeName}
          onChange={(e) => setThemeName(e.target.value)}
          className={styles.input}
        />
        <button
          className={styles.saveBtn}
          onClick={handleSaveTheme}
          disabled={!themeName.trim()}
        >
          ğŸ’¾ ä¿å­˜ä¸ºæ–°ä¸»é¢˜
        </button>
      </div>

      {/* æˆ‘çš„ä¸»é¢˜ */}
      {themes.filter((t) => t.type === 'custom').length > 0 && (
        <div className={styles.section}>
          <label className={styles.label}>æˆ‘çš„ä¸»é¢˜</label>
          <div className={styles.themeGrid}>
            {themes
              .filter((t) => t.type === 'custom')
              .map((theme) => (
                <div
                  key={theme.id}
                  className={styles.customThemeCard}
                  onClick={() => handleThemeSelect(theme.id)}
                >
                  <div className={styles.customThemeHeader}>
                    <span className={styles.customThemeName}>{theme.name}</span>
                    <button
                      className={styles.deleteBtn}
                      onClick={(e) => {
                        e.stopPropagation();
                        deleteTheme(theme.id);
                      }}
                    >
                      ğŸ—‘ï¸
                    </button>
                  </div>
                  <span className={styles.customThemePreview}>Aa é¢„è§ˆ</span>
                </div>
              ))}
          </div>
        </div>
      )}

      {/* æ»šåŠ¨æç¤º */}
      <div className={styles.scrollHint}>
        <span>â‡… æ»šåŠ¨æŸ¥çœ‹æ›´å¤š</span>
      </div>
    </div>
  );
};

const FONT_OPTIONS = [
  { label: 'Playfair Displayï¼ˆè¡¬çº¿ï¼‰', value: 'Playfair Display' },
  { label: 'Interï¼ˆæ— è¡¬çº¿ï¼‰', value: 'Inter' },
];

const LETTER_SPACING_OPTIONS = [
  { label: 'ç´§å‡‘', value: 'tight' },
  { label: 'æ ‡å‡†', value: 'normal' },
  { label: 'å®½æ¾', value: 'wide' },
];

const LINE_HEIGHT_OPTIONS = [
  { label: '1.5', value: 1.5 },
  { label: '1.8', value: 1.8 },
  { label: '2.0', value: 2.0 },
];
```

#### 3. é¢œè‰²é€‰æ‹©å™¨ç»„ä»¶

```typescript
// components/UI/ColorPicker.tsx
import React, { useState, useRef } from 'react';
import styles from './ColorPicker.module.css';

interface ColorPickerProps {
  value: string;
  onChange: (color: string) => void;
}

export const ColorPicker: React.FC<ColorPickerProps> = ({ value, onChange }) => {
  const [isOpen, setIsOpen] = useState(false);
  const inputRef = useRef<HTMLInputElement>(null);

  const handleColorChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    onChange(e.target.value);
  };

  const handleSwatchClick = () => {
    inputRef.current?.click();
  };

  return (
    <div className={styles.colorPicker}>
      <div className={styles.swatch} onClick={handleSwatchClick}>
        <div className={styles.color} style={{ backgroundColor: value }} />
      </div>
      <span className={styles.value}>{value}</span>
      <input
        ref={inputRef}
        type="color"
        value={value}
        onChange={handleColorChange}
        className={styles.hiddenInput}
      />
    </div>
  );
};
```

---

## ä¸»é¢˜ç³»ç»Ÿå®ç°

### ä¸»é¢˜ç®¡ç† Store

```typescript
// stores/themeStore.ts
import { create } from 'zustand';
import { persist } from 'zustand/middleware';
import { Theme, ReaderSettings } from '@/types';

interface ThemeStore {
  themes: Theme[];
  activeThemeId: string;
  isCustomMode: boolean;
  
  // Actions
  applyTheme: (themeId: string) => void;
  saveTheme: (name: string, settings: ReaderSettings) => void;
  deleteTheme: (themeId: string) => void;
  setCustomMode: (isCustom: boolean) => void;
}

export const useThemeStore = create<ThemeStore>()(
  persist(
    (set, get) => ({
      themes: PRESET_THEMES,
      activeThemeId: 'light',
      isCustomMode: false,

      applyTheme: (themeId: string) => {
        const theme = get().themes.find((t) => t.id === themeId);
        if (theme) {
          // åº”ç”¨ä¸»é¢˜è®¾ç½®åˆ°è®¾ç½®store
          useSettingsStore.getState().updateSettings(theme.settings);
          set({ activeThemeId: themeId, isCustomMode: false });
        }
      },

      saveTheme: (name: string, settings: ReaderSettings) => {
        const newTheme: Theme = {
          id: `custom-${Date.now()}`,
          name,
          type: 'custom',
          settings,
          createdAt: new Date(),
        };
        set((state) => ({
          themes: [...state.themes, newTheme],
          activeThemeId: newTheme.id,
          isCustomMode: false,
        }));
      },

      deleteTheme: (themeId: string) => {
        set((state) => ({
          themes: state.themes.filter((t) => t.id !== themeId),
        }));
      },

      setCustomMode: (isCustom: boolean) => {
        set({ isCustomMode: isCustom });
      },
    }),
    {
      name: 'theme-storage',
    }
  )
);
```

### è®¾ç½®ç®¡ç† Store

```typescript
// stores/settingsStore.ts
import { create } from 'zustand';
import { persist } from 'zustand/middleware';
import { ReaderSettings } from '@/types';

interface SettingsStore {
  settings: ReaderSettings;
  updateSettings: (settings: Partial<ReaderSettings>) => void;
  resetSettings: () => void;
}

const DEFAULT_SETTINGS: ReaderSettings = {
  fontFamily: 'Playfair Display',
  fontSize: 20,
  letterSpacing: 'normal',
  lineHeight: 1.8,
  backgroundColor: '#FFFFFF',
  textColor: '#000000',
};

export const useSettingsStore = create<SettingsStore>()(
  persist(
    (set) => ({
      settings: DEFAULT_SETTINGS,

      updateSettings: (newSettings: Partial<ReaderSettings>) => {
        set((state) => ({
          settings: { ...state.settings, ...newSettings },
        }));
        // è§¦å‘è‡ªå®šä¹‰æ¨¡å¼
        useThemeStore.getState().setCustomMode(true);
      },

      resetSettings: () => {
        set({ settings: DEFAULT_SETTINGS });
      },
    }),
    {
      name: 'settings-storage',
    }
  )
);
```

---

## çŠ¶æ€ç®¡ç†æ–¹æ¡ˆ

### Zustand Store æ¶æ„

```typescript
// stores/index.ts
export { useBookStore } from './bookStore';
export { useThemeStore } from './themeStore';
export { useSettingsStore } from './settingsStore';
export { useUIStore } from './uiStore';
```

### ä¹¦ç±ç®¡ç† Store

```typescript
// stores/bookStore.ts
import { create } from 'zustand';
import { Book, BookContent } from '@/types';
import { bookService } from '@/services/bookService';

interface BookStore {
  books: Book[];
  currentBook: Book | null;
  currentContent: BookContent | null;
  isLoading: boolean;
  error: string | null;

  // Actions
  loadBooks: () => Promise<void>;
  importBook: (filePath: string) => Promise<void>;
  openBook: (bookId: string) => Promise<void>;
  closeBook: () => void;
  deleteBook: (bookId: string) => Promise<void>;
  updateProgress: (bookId: string, page: number, progress: number) => Promise<void>;
}

export const useBookStore = create<BookStore>((set, get) => ({
  books: [],
  currentBook: null,
  currentContent: null,
  isLoading: false,
  error: null,

  loadBooks: async () => {
    set({ isLoading: true, error: null });
    try {
      const books = await bookService.getAllBooks();
      set({ books, isLoading: false });
    } catch (error) {
      set({ error: error.message, isLoading: false });
    }
  },

  importBook: async (filePath: string) => {
    set({ isLoading: true, error: null });
    try {
      const book = await bookService.importBook(filePath);
      set((state) => ({
        books: [book, ...state.books],
        isLoading: false,
      }));
    } catch (error) {
      set({ error: error.message, isLoading: false });
    }
  },

  openBook: async (bookId: string) => {
    set({ isLoading: true, error: null });
    try {
      const book = get().books.find((b) => b.id === bookId);
      if (!book) throw new Error('Book not found');

      const content = await bookService.getBookContent(bookId);
      set({
        currentBook: book,
        currentContent: content,
        isLoading: false,
      });
    } catch (error) {
      set({ error: error.message, isLoading: false });
    }
  },

  closeBook: () => {
    set({ currentBook: null, currentContent: null });
  },

  deleteBook: async (bookId: string) => {
    try {
      await bookService.deleteBook(bookId);
      set((state) => ({
        books: state.books.filter((b) => b.id !== bookId),
      }));
    } catch (error) {
      set({ error: error.message });
    }
  },

  updateProgress: async (bookId: string, page: number, progress: number) => {
    try {
      await bookService.updateProgress(bookId, page, progress);
      set((state) => ({
        books: state.books.map((b) =>
          b.id === bookId
            ? { ...b, currentPage: page, progress, lastReadAt: new Date() }
            : b
        ),
      }));
    } catch (error) {
      console.error('Failed to update progress:', error);
    }
  },
}));
```

---

## æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 1. è™šæ‹Ÿæ»šåŠ¨

å¯¹äºè¶…é•¿æ–‡æ¡£ï¼Œä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨å‡å°‘DOMèŠ‚ç‚¹ï¼š

```typescript
// ä½¿ç”¨ react-window æˆ– react-virtuoso
import { Virtuoso } from 'react-virtuoso';

<Virtuoso
  style={{ height: '100%' }}
  totalCount={paragraphs.length}
  itemContent={(index) => <Paragraph data={paragraphs[index]} />}
/>
```

### 2. æ–‡æœ¬åˆ†å—åŠ è½½

```typescript
// å°†é•¿æ–‡æ¡£åˆ†æˆå¤šä¸ªå—ï¼ŒæŒ‰éœ€åŠ è½½
interface TextChunk {
  id: number;
  startOffset: number;
  endOffset: number;
  content: string;
}

async function loadChunk(bookId: string, chunkId: number): Promise<TextChunk> {
  // ä»IndexedDBæŒ‰éœ€åŠ è½½æ–‡æœ¬å—
}
```

### 3. å›¾ç‰‡æ‡’åŠ è½½

```typescript
// ä½¿ç”¨Intersection Observerå®ç°æ‡’åŠ è½½
import { useInView } from 'react-intersection-observer';

const LazyImage: React.FC<{ src: string }> = ({ src }) => {
  const { ref, inView } = useInView({ triggerOnce: true });
  
  return (
    <div ref={ref}>
      {inView ? <img src={src} /> : <div className="placeholder" />}
    </div>
  );
};
```

### 4. é˜²æŠ–ä¸èŠ‚æµ

```typescript
// æ»šåŠ¨ä½ç½®ä¿å­˜ï¼ˆèŠ‚æµï¼‰
import { throttle } from 'lodash';

const saveScrollPosition = throttle((bookId: string, position: number) => {
  bookService.updateScrollPosition(bookId, position);
}, 5000);

// æœç´¢è¾“å…¥ï¼ˆé˜²æŠ–ï¼‰
import { debounce } from 'lodash';

const handleSearch = debounce((query: string) => {
  searchService.search(query);
}, 300);
```

### 5. Web Worker

å°†è€—æ—¶æ“ä½œç§»åˆ°Web Workerï¼š

```typescript
// workers/bookParser.worker.ts
self.addEventListener('message', async (e) => {
  const { type, data } = e.data;
  
  if (type === 'PARSE_EPUB') {
    const result = await parseEpub(data.filePath);
    self.postMessage({ type: 'PARSE_COMPLETE', data: result });
  }
});
```

### 6. IndexedDB æ‰¹é‡æ“ä½œ

```typescript
// æ‰¹é‡ä¿å­˜ä¹¦ç­¾
async function saveBatchBookmarks(bookmarks: Bookmark[]): Promise<void> {
  const db = await openDB();
  const tx = db.transaction('bookmarks', 'readwrite');
  
  await Promise.all([
    ...bookmarks.map((bookmark) => tx.store.add(bookmark)),
    tx.done,
  ]);
}
```

---

## å¼€å‘è·¯çº¿å›¾

### é˜¶æ®µ1ï¼šåŸºç¡€æ¡†æ¶æ­å»ºï¼ˆç¬¬1-2å‘¨ï¼‰

- [ ] åˆå§‹åŒ–Electron + Reacté¡¹ç›®
- [ ] é…ç½®TypeScriptã€Viteã€ESLintã€Prettier
- [ ] è®¾ç½®é¡¹ç›®ç›®å½•ç»“æ„
- [ ] å®ç°Electronä¸»è¿›ç¨‹ä¸æ¸²æŸ“è¿›ç¨‹é€šä¿¡
- [ ] é…ç½®IndexedDBæ•°æ®åº“
- [ ] å®ç°åŸºç¡€çš„è·¯ç”±ç³»ç»Ÿ

### é˜¶æ®µ2ï¼šå¯åŠ¨é¡µå¼€å‘ï¼ˆç¬¬2-3å‘¨ï¼‰

- [ ] å®ç°å¯åŠ¨é¡µå¸ƒå±€
- [ ] å®ç°ä¹¦ç±å¡ç‰‡ç»„ä»¶
- [ ] å®ç°"å¯¼å…¥æ–°ä¹¦"å’Œ"æ‰“å¼€æ–‡ä»¶"åŠŸèƒ½
- [ ] å®ç°æœ€è¿‘é˜…è¯»åˆ—è¡¨å±•ç¤º
- [ ] å®ç°æ‹–æ‹½å¯¼å…¥åŠŸèƒ½
- [ ] æ·»åŠ ä¹¦ç±ç®¡ç†åŠŸèƒ½ï¼ˆåˆ é™¤ï¼‰

### é˜¶æ®µ3ï¼šç”µå­ä¹¦è§£æï¼ˆç¬¬3-4å‘¨ï¼‰

- [ ] é›†æˆepubjsè§£æEPUBæ–‡ä»¶
- [ ] é›†æˆpdf.jsè§£æPDFæ–‡ä»¶
- [ ] å®ç°TXTæ–‡ä»¶è§£æ
- [ ] æå–ä¹¦ç±å…ƒæ•°æ®ï¼ˆä¹¦åã€ä½œè€…ã€å°é¢ï¼‰
- [ ] å®ç°ä¹¦ç±å†…å®¹ç¼“å­˜æœºåˆ¶
- [ ] å¤„ç†è§£æé”™è¯¯å’Œå¼‚å¸¸æƒ…å†µ

### é˜¶æ®µ4ï¼šé˜…è¯»å™¨æ ¸å¿ƒåŠŸèƒ½ï¼ˆç¬¬4-6å‘¨ï¼‰

- [ ] å®ç°é˜…è¯»å™¨ä¸»ç•Œé¢å¸ƒå±€
- [ ] å®ç°å†…å®¹æ¸²æŸ“ç»„ä»¶
- [ ] å®ç°çºµå‘æ»šåŠ¨
- [ ] å®ç°é¡¶éƒ¨å·¥å…·æ 
- [ ] å®ç°åº•éƒ¨è¿›åº¦æ¡
- [ ] å®ç°é˜…è¯»è¿›åº¦ä¿å­˜å’Œæ¢å¤
- [ ] å®ç°é”®ç›˜å¿«æ·é”®
- [ ] å®ç°é¡µé¢è·³è½¬

### é˜¶æ®µ5ï¼šè®¾ç½®é¢æ¿å¼€å‘ï¼ˆç¬¬6-7å‘¨ï¼‰

- [ ] å®ç°è®¾ç½®é¢æ¿å¸ƒå±€
- [ ] å®ç°å­—ä½“é€‰æ‹©ç»„ä»¶
- [ ] å®ç°å­—å·è°ƒèŠ‚ç»„ä»¶
- [ ] å®ç°å­—é—´è·é€‰æ‹©ç»„ä»¶
- [ ] å®ç°è¡Œè·é€‰æ‹©ç»„ä»¶
- [ ] å®ç°é¢œè‰²é€‰æ‹©å™¨ç»„ä»¶
- [ ] å®ç°è®¾ç½®å®æ—¶åº”ç”¨
- [ ] å®ç°è®¾ç½®æŒä¹…åŒ–

### é˜¶æ®µ6ï¼šä¸»é¢˜ç³»ç»Ÿï¼ˆç¬¬7-8å‘¨ï¼‰

- [ ] å®ç°é¢„è®¾ä¸»é¢˜ï¼ˆæµ…è‰²ã€æ·±è‰²ã€æš–è‰²ï¼‰
- [ ] å®ç°ä¸»é¢˜åˆ‡æ¢é€»è¾‘
- [ ] å®ç°è‡ªå®šä¹‰ä¸»é¢˜æ£€æµ‹
- [ ] å®ç°ä¿å­˜è‡ªå®šä¹‰ä¸»é¢˜åŠŸèƒ½
- [ ] å®ç°"æˆ‘çš„ä¸»é¢˜"åˆ—è¡¨å±•ç¤º
- [ ] å®ç°ä¸»é¢˜åˆ é™¤åŠŸèƒ½
- [ ] å®ç°ä¸»é¢˜æ•°æ®æŒä¹…åŒ–

### é˜¶æ®µ7ï¼šä¹¦ç­¾ä¸ç¬”è®°ï¼ˆç¬¬8-9å‘¨ï¼‰

- [ ] å®ç°æ·»åŠ /åˆ é™¤ä¹¦ç­¾åŠŸèƒ½
- [ ] å®ç°ä¹¦ç­¾åˆ—è¡¨å±•ç¤º
- [ ] å®ç°æ–‡æœ¬é«˜äº®åŠŸèƒ½
- [ ] å®ç°ç¬”è®°æ·»åŠ /ç¼–è¾‘åŠŸèƒ½
- [ ] å®ç°ä¹¦ç­¾è·³è½¬
- [ ] å®ç°ä¹¦ç­¾æ•°æ®æŒä¹…åŒ–

### é˜¶æ®µ8ï¼šæœç´¢åŠŸèƒ½ï¼ˆç¬¬9å‘¨ï¼‰

- [ ] å®ç°å…¨æ–‡æœç´¢
- [ ] å®ç°æœç´¢ç»“æœé«˜äº®
- [ ] å®ç°æœç´¢ç»“æœåˆ—è¡¨
- [ ] å®ç°è·³è½¬åˆ°æœç´¢ç»“æœ
- [ ] ä¼˜åŒ–æœç´¢æ€§èƒ½ï¼ˆç´¢å¼•ï¼‰

### é˜¶æ®µ9ï¼šæ€§èƒ½ä¼˜åŒ–ï¼ˆç¬¬10å‘¨ï¼‰

- [ ] å®ç°è™šæ‹Ÿæ»šåŠ¨
- [ ] å®ç°æ–‡æœ¬åˆ†å—åŠ è½½
- [ ] å®ç°å›¾ç‰‡æ‡’åŠ è½½
- [ ] ä¼˜åŒ–IndexedDBæ“ä½œ
- [ ] å®ç°Web Workerå¤„ç†è€—æ—¶ä»»åŠ¡
- [ ] æ€§èƒ½æµ‹è¯•å’Œè°ƒä¼˜

### é˜¶æ®µ10ï¼šæµ‹è¯•ä¸å‘å¸ƒï¼ˆç¬¬11-12å‘¨ï¼‰

- [ ] å•å…ƒæµ‹è¯•ï¼ˆJest + React Testing Libraryï¼‰
- [ ] é›†æˆæµ‹è¯•
- [ ] ç«¯åˆ°ç«¯æµ‹è¯•ï¼ˆPlaywrightï¼‰
- [ ] æ‰“åŒ…é…ç½®ï¼ˆelectron-builderï¼‰
- [ ] å¤šå¹³å°æ‰“åŒ…ï¼ˆWindowsã€macOSã€Linuxï¼‰
- [ ] å®‰è£…åŒ…æµ‹è¯•
- [ ] ç¼–å†™ç”¨æˆ·æ–‡æ¡£
- [ ] æ­£å¼å‘å¸ƒ

---

## æŠ€æœ¯éš¾ç‚¹ä¸è§£å†³æ–¹æ¡ˆ

### 1. EPUBæ–‡ä»¶è§£æ

**éš¾ç‚¹**: EPUBæ˜¯å‹ç¼©çš„HTML+XML+CSSåŒ…ï¼Œéœ€è¦æ­£ç¡®è§£æç»“æ„

**è§£å†³æ–¹æ¡ˆ**:
```typescript
import ePub from 'epubjs';

async function parseEpub(filePath: string): Promise<BookData> {
  const book = ePub(filePath);
  
  // è¯»å–å…ƒæ•°æ®
  const metadata = await book.loaded.metadata;
  
  // è¯»å–å°é¢
  const coverUrl = await book.coverUrl();
  
  // è¯»å–å†…å®¹
  await book.ready;
  const spine = book.spine;
  
  let fullContent = '';
  for (const item of spine.items) {
    const content = await item.load(book.load.bind(book));
    fullContent += content.outerHTML;
  }
  
  return {
    title: metadata.title,
    author: metadata.creator,
    cover: coverUrl,
    content: fullContent,
  };
}
```

### 2. PDFæ¸²æŸ“æ€§èƒ½

**éš¾ç‚¹**: PDFæ–‡ä»¶è¾ƒå¤§ï¼Œæ¸²æŸ“æ€§èƒ½å·®

**è§£å†³æ–¹æ¡ˆ**:
- ä½¿ç”¨pdf.jsçš„Workeræ¨¡å¼
- åªæ¸²æŸ“å½“å‰é¡µå’Œå‰åå‡ é¡µ
- ä½¿ç”¨Canvasæ¸²æŸ“è€ŒéSVG

```typescript
import * as pdfjsLib from 'pdfjs-dist';

// é…ç½®Worker
pdfjsLib.GlobalWorkerOptions.workerSrc = 'pdf.worker.js';

async function renderPdfPage(pdf: any, pageNumber: number, canvas: HTMLCanvasElement) {
  const page = await pdf.getPage(pageNumber);
  const viewport = page.getViewport({ scale: 1.5 });
  
  const context = canvas.getContext('2d');
  canvas.width = viewport.width;
  canvas.height = viewport.height;
  
  await page.render({
    canvasContext: context,
    viewport: viewport,
  }).promise;
}
```

### 3. å¤§æ–‡ä»¶å¤„ç†

**éš¾ç‚¹**: å¤§å‹ç”µå­ä¹¦æ–‡ä»¶ï¼ˆæ•°ç™¾MBï¼‰å¯¼è‡´å†…å­˜æº¢å‡º

**è§£å†³æ–¹æ¡ˆ**:
- ä½¿ç”¨æµå¼è¯»å–
- åˆ†å—å­˜å‚¨åˆ°IndexedDB
- æŒ‰éœ€åŠ è½½å†…å®¹

```typescript
async function importLargeBook(filePath: string): Promise<void> {
  const CHUNK_SIZE = 1024 * 1024; // 1MB
  const stream = fs.createReadStream(filePath, { highWaterMark: CHUNK_SIZE });
  
  let chunkIndex = 0;
  for await (const chunk of stream) {
    await saveChunk(bookId, chunkIndex, chunk);
    chunkIndex++;
  }
}
```

### 4. ä¸»é¢˜å®æ—¶åˆ‡æ¢

**éš¾ç‚¹**: ä¸»é¢˜åˆ‡æ¢æ—¶éœ€è¦ç«‹å³åº”ç”¨æ‰€æœ‰è®¾ç½®

**è§£å†³æ–¹æ¡ˆ**:
- ä½¿ç”¨CSSå˜é‡å®ç°åŠ¨æ€æ ·å¼
- Zustand storeç»Ÿä¸€ç®¡ç†çŠ¶æ€
- useEffectç›‘å¬å˜åŒ–å¹¶åº”ç”¨

```typescript
// åœ¨æ ¹ç»„ä»¶åº”ç”¨CSSå˜é‡
useEffect(() => {
  const root = document.documentElement;
  root.style.setProperty('--bg-color', settings.backgroundColor);
  root.style.setProperty('--text-color', settings.textColor);
  // ... å…¶ä»–å˜é‡
}, [settings]);
```

### 5. è·¨å¹³å°æ–‡ä»¶è®¿é—®

**éš¾ç‚¹**: ä¸åŒæ“ä½œç³»ç»Ÿçš„æ–‡ä»¶è·¯å¾„å’Œæƒé™ä¸åŒ

**è§£å†³æ–¹æ¡ˆ**:
- ä½¿ç”¨Electronçš„dialog API
- ä½¿ç”¨pathæ¨¡å—å¤„ç†è·¯å¾„
- è¯·æ±‚å¿…è¦çš„æ–‡ä»¶ç³»ç»Ÿæƒé™

```typescript
import { dialog } from 'electron';
import path from 'path';

async function selectBookFile(): Promise<string | null> {
  const result = await dialog.showOpenDialog({
    properties: ['openFile'],
    filters: [
      { name: 'E-Books', extensions: ['epub', 'pdf', 'txt'] },
    ],
  });
  
  if (result.canceled) return null;
  return result.filePaths[0];
}
```

---

## å¼€å‘ç¯å¢ƒé…ç½®

### å®‰è£…ä¾èµ–

```bash
# åˆå§‹åŒ–é¡¹ç›®
npm create vite@latest ebook-reader -- --template react-ts
cd ebook-reader

# å®‰è£…Electron
npm install -D electron electron-builder electron-vite

# å®‰è£…Reactç”Ÿæ€
npm install react react-dom
npm install -D @types/react @types/react-dom

# å®‰è£…çŠ¶æ€ç®¡ç†
npm install zustand

# å®‰è£…ç”µå­ä¹¦è§£æ
npm install epubjs pdfjs-dist

# å®‰è£…æœ¬åœ°å­˜å‚¨
npm install localforage idb

# å®‰è£…å·¥å…·åº“
npm install lodash
npm install -D @types/lodash

# å®‰è£…æ ·å¼ç›¸å…³
npm install postcss autoprefixer

# å®‰è£…å¼€å‘å·¥å…·
npm install -D eslint prettier
npm install -D @typescript-eslint/parser @typescript-eslint/eslint-plugin
```

### package.json è„šæœ¬

```json
{
  "scripts": {
    "dev": "electron-vite dev",
    "build": "electron-vite build",
    "preview": "electron-vite preview",
    "pack": "electron-builder --dir",
    "dist": "electron-builder",
    "dist:win": "electron-builder --win",
    "dist:mac": "electron-builder --mac",
    "dist:linux": "electron-builder --linux"
  }
}
```

---

## æµ‹è¯•ç­–ç•¥

### å•å…ƒæµ‹è¯•

```typescript
// __tests__/themeStore.test.ts
import { renderHook, act } from '@testing-library/react';
import { useThemeStore } from '@/stores/themeStore';

describe('ThemeStore', () => {
  it('should apply theme correctly', () => {
    const { result } = renderHook(() => useThemeStore());
    
    act(() => {
      result.current.applyTheme('dark');
    });
    
    expect(result.current.activeThemeId).toBe('dark');
    expect(result.current.isCustomMode).toBe(false);
  });
  
  it('should save custom theme', () => {
    const { result } = renderHook(() => useThemeStore());
    
    const settings = {
      fontFamily: 'Inter',
      fontSize: 22,
      backgroundColor: '#000000',
      textColor: '#FFFFFF',
    };
    
    act(() => {
      result.current.saveTheme('My Theme', settings);
    });
    
    const customThemes = result.current.themes.filter(t => t.type === 'custom');
    expect(customThemes).toHaveLength(1);
    expect(customThemes[0].name).toBe('My Theme');
  });
});
```

### é›†æˆæµ‹è¯•

```typescript
// __tests__/Reader.integration.test.tsx
import { render, screen, fireEvent } from '@testing-library/react';
import { ReaderPage } from '@/pages/ReaderPage';

describe('ReaderPage Integration', () => {
  it('should apply settings from panel to reader view', async () => {
    render(<ReaderPage bookId="test-book-id" />);
    
    // æ‰“å¼€è®¾ç½®é¢æ¿
    fireEvent.click(screen.getByLabelText('è®¾ç½®'));
    
    // ä¿®æ”¹å­—å·
    fireEvent.click(screen.getByText('+'));
    
    // æ£€æŸ¥é˜…è¯»è§†å›¾æ˜¯å¦åº”ç”¨äº†æ–°å­—å·
    const readerView = screen.getByTestId('reader-view');
    expect(readerView).toHaveStyle({ fontSize: '21px' });
  });
});
```

---

## éƒ¨ç½²ä¸å‘å¸ƒ

### Electron Builder é…ç½®

```json
// electron-builder.json
{
  "appId": "com.ebook.reader",
  "productName": "ç”µå­ä¹¦é˜…è¯»å™¨",
  "directories": {
    "buildResources": "build",
    "output": "dist"
  },
  "files": [
    "dist-electron/**/*",
    "dist/**/*",
    "package.json"
  ],
  "win": {
    "target": ["nsis", "portable"],
    "icon": "build/icon.ico"
  },
  "mac": {
    "target": ["dmg", "zip"],
    "icon": "build/icon.icns",
    "category": "public.app-category.productivity"
  },
  "linux": {
    "target": ["AppImage", "deb"],
    "icon": "build/icon.png",
    "category": "Office"
  },
  "nsis": {
    "oneClick": false,
    "allowToChangeInstallationDirectory": true,
    "createDesktopShortcut": true,
    "createStartMenuShortcut": true
  }
}
```

### æ‰“åŒ…å‘½ä»¤

```bash
# Windows
npm run dist:win

# macOS
npm run dist:mac

# Linux
npm run dist:linux

# æ‰€æœ‰å¹³å°
npm run dist
```

---

## æ€»ç»“

æœ¬æŠ€æœ¯æ–¹æ¡ˆæä¾›äº†å®Œæ•´çš„ç”µå­ä¹¦é˜…è¯»å™¨å®ç°è·¯å¾„ï¼Œä»æŠ€æœ¯é€‰å‹åˆ°å…·ä½“å®ç°ç»†èŠ‚éƒ½æœ‰è¯¦ç»†è¯´æ˜ã€‚ä¸»è¦ç‰¹ç‚¹ï¼š

1. **æŠ€æœ¯æ ˆæˆç†Ÿ**: Electron + Reactç”Ÿæ€å®Œå–„ï¼Œç¤¾åŒºæ”¯æŒå¼º
2. **æ¶æ„æ¸…æ™°**: åˆ†å±‚è®¾è®¡ï¼ŒèŒè´£æ˜ç¡®
3. **æ€§èƒ½ä¼˜åŒ–**: è™šæ‹Ÿæ»šåŠ¨ã€æ‡’åŠ è½½ã€Web Workerç­‰å¤šç§ä¼˜åŒ–æ‰‹æ®µ
4. **å¯æ‰©å±•æ€§å¼º**: ä¸»é¢˜ç³»ç»Ÿã€æ’ä»¶åŒ–è®¾è®¡ï¼Œæ˜“äºæ‰©å±•æ–°åŠŸèƒ½
5. **ç”¨æˆ·ä½“éªŒä½³**: å®Œå…¨åŸºäºPencilè®¾è®¡ç¨¿å®ç°ï¼Œä¿è¯UI/UXä¸€è‡´æ€§

### é¢„ä¼°å¼€å‘å‘¨æœŸ

- **æœ€å°å¯ç”¨ç‰ˆæœ¬ (MVP)**: 6å‘¨
  - å¯åŠ¨é¡µ + é˜…è¯»å™¨ + åŸºç¡€è®¾ç½®
- **å®Œæ•´åŠŸèƒ½ç‰ˆæœ¬**: 12å‘¨
  - åŒ…å«æ‰€æœ‰è®¾è®¡çš„åŠŸèƒ½
- **ä¼˜åŒ–æ‰“ç£¨ç‰ˆæœ¬**: +2å‘¨
  - æ€§èƒ½ä¼˜åŒ– + æµ‹è¯• + å‘å¸ƒ

### æŠ€æœ¯é£é™©è¯„ä¼°

| é£é™©é¡¹ | é£é™©ç­‰çº§ | åº”å¯¹æªæ–½ |
|--------|---------|---------|
| EPUBè§£æå…¼å®¹æ€§ | ä¸­ | ä½¿ç”¨æˆç†Ÿçš„epubjsåº“ |
| PDFæ¸²æŸ“æ€§èƒ½ | é«˜ | ä½¿ç”¨Worker + åˆ†é¡µæ¸²æŸ“ |
| å¤§æ–‡ä»¶å†…å­˜æº¢å‡º | é«˜ | æµå¼è¯»å– + åˆ†å—å­˜å‚¨ |
| è·¨å¹³å°å…¼å®¹æ€§ | ä¸­ | å……åˆ†æµ‹è¯•å„å¹³å° |
| IndexedDBé™åˆ¶ | ä½ | ç›‘æ§å­˜å‚¨ç”¨é‡ |

---

**æ–‡æ¡£ç»´æŠ¤**: è¯·æ ¹æ®å®é™…å¼€å‘è¿›åº¦æ›´æ–°æœ¬æ–‡æ¡£  
**é—®é¢˜åé¦ˆ**: æ¬¢è¿æå‡ºæ”¹è¿›å»ºè®®

